<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PUBG ì¶”ì²œ ì´ê¸° ì¸¡ì •ê¸° V12</title>
    <style>
        :root { --p: #ffb400; --bg: #0b0b0b; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: sans-serif; overflow: hidden; touch-action: none; text-align: center; user-select: none; }
        #wrap { padding: 15px; }
        #screen { width: 100%; height: 280px; background: #000; border: 2px solid #444; position: relative; overflow: hidden; border-radius: 15px; margin: 10px 0; }
        .target { position: absolute; width: 24px; height: 24px; background: red; border-radius: 50%; left: 50%; top: 50%; transform: translate(-50%, -50%); border: 2px solid #fff; box-shadow: 0 0 10px red; }
        .aim { position: absolute; width: 20px; height: 20px; border: 2px solid #0f0; border-radius: 50%; transform: translate(-50%, -50%); pointer-events: none; z-index: 10; left: 50%; top: 50%; }
        #mainBtn { width: 100%; padding: 18px; background: var(--p); border: none; border-radius: 12px; font-weight: 900; font-size: 1.3rem; color: #000; cursor: pointer; display: block; }
        #mainBtn:disabled { background: #444 !important; color: #888; cursor: not-allowed; }
        #status { color: var(--p); font-size: 1rem; height: 24px; margin-bottom: 5px; font-weight: bold; }
        #result { display: none; background: #1a1a1a; padding: 20px; border-radius: 15px; border: 2px solid var(--p); margin-top: 5px; }
    </style>
</head>
<body>

<div id="wrap">
    <h2 style="margin: 5px 0;">ğŸ¯ PUBG ANALYZER V12</h2>
    <div id="status">ì¤€ë¹„ ì™„ë£Œ! ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.</div>
    
    <div id="screen">
        <div id="tg" class="target"></div>
        <div id="am" class="aim"></div>
    </div>

    <button id="mainBtn">ì¸¡ì • ì‹œì‘</button>

    <div id="result">
        <h3 id="res-gun" style="color:var(--p); margin: 5px 0;"></h3>
        <p id="res-score" style="font-size: 0.85rem; color: #aaa; white-space: pre-line; margin-bottom: 15px;"></p>
        <button onclick="resetAll()" style="background:#444; color:#fff; font-size: 1rem; padding: 10px; width: 100%; border: none; border-radius: 8px;">ğŸ”„ ë‹¤ì‹œ ì¸¡ì •í•˜ê¸°</button>
    </div>
</div>

<script>
    let stage = 0; 
    let score = { recoil: 0, react: 0, move: 0 };
    let ax, ay, isDragging = false, startTime = 0;
    let mainTimer = null;
    
    const btn = document.getElementById('mainBtn');
    const am = document.getElementById('am');
    const tg = document.getElementById('tg');
    const screen = document.getElementById('screen');
    const status = document.getElementById('status');
    const resultBox = document.getElementById('result');

    // 1. ì™„ì „ ì´ˆê¸°í™” (ëª¨ë“  ì–µê¹Œ ë°©ì§€)
    function resetAll() {
        // íƒ€ì´ë¨¸ í™•ì‹¤í•˜ê²Œ ì œê±°
        if(mainTimer) {
            clearInterval(mainTimer);
            mainTimer = null;
        }
        
        // ìƒíƒœ ì´ˆê¸°í™”
        stage = 0;
        score = { recoil: 0, react: 0, move: 0 };
        isDragging = false;
        startTime = 0;
        
        // ë²„íŠ¼ ì‚´ë ¤ë‚´ê¸°
        btn.disabled = false;
        btn.style.display = "block";
        btn.style.background = "var(--p)";
        btn.innerText = "ì¸¡ì • ì‹œì‘";
        
        // UI ì´ˆê¸°í™”
        status.innerText = "ì¤€ë¹„ ì™„ë£Œ! ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.";
        resultBox.style.display = "none";
        tg.style.left = "50%";
        tg.style.top = "50%";
        tg.style.display = "block";
        
        // ì—ì„ ìœ„ì¹˜ ì´ˆê¸°í™”
        ax = screen.clientWidth / 2;
        ay = screen.clientHeight / 2;
        updateUI();
    }

    function updateUI() {
        am.style.left = ax + 'px';
        am.style.top = ay + 'px';
    }

    // ë²„íŠ¼ ë¡œì§ (ë‹¨ê³„ë³„ë¡œ ì‘ë™í•˜ê²Œ ì •ë¦¬)
    btn.onclick = () => {
        if (stage === 0) {
            stage = 1;
            startRecoil();
        } else if (stage === 3) {
            const now = performance.now();
            score.react = now - startTime;
            stage = 4;
            startMove();
        }
    };

    // ì—ì„ ë“œë˜ê·¸ ë¡œì§
    const handleMove = (clientX, clientY) => {
        const rect = screen.getBoundingClientRect();
        ax = clientX - rect.left;
        ay = clientY - rect.top;
        ax = Math.max(0, Math.min(screen.clientWidth, ax));
        ay = Math.max(0, Math.min(screen.clientHeight, ay));
        updateUI();
    };

    screen.onpointerdown = (e) => { isDragging = true; handleMove(e.clientX, e.clientY); };
    window.onpointermove = (e) => { if(isDragging) handleMove(e.clientX, e.clientY); };
    window.onpointerup = () => { isDragging = false; };

    // ë‹¨ê³„ë³„ í•¨ìˆ˜ë“¤
    function startRecoil() {
        status.innerText = "1ë‹¨ê³„: ë°˜ë™ ì œì–´ (í™”ë©´ ë“œë˜ê·¸!)";
        btn.innerText = "ë°˜ë™ ì œì–´ ì¤‘...";
        btn.disabled = true; // ì¸¡ì • ì¤‘ì—” ë²„íŠ¼ í´ë¦­ ë°©ì§€
        let cnt = 0, diff = 0;
        
        mainTimer = setInterval(() => {
            ay -= 10; 
            ax += (Math.random() - 0.5) * 22; 
            updateUI();
            diff += Math.hypot(ax - screen.clientWidth/2, ay - screen.clientHeight/2);
            
            if(++cnt > 80) {
                clearInterval(mainTimer);
                score.recoil = diff / 80;
                prepReact();
            }
        }, 50);
    }

    function prepReact() {
        stage = 2;
        status.innerText = "2ë‹¨ê³„: ì´ˆë¡ìƒ‰ ë³€í•  ë•Œ í´ë¦­!";
        btn.innerText = "ëŒ€ê¸°...";
        btn.disabled = true;
        btn.style.background = "#333";
        
        setTimeout(() => {
            if(stage !== 2) return;
            stage = 3;
            startTime = performance.now();
            btn.disabled = false; // ë°˜ì‘ì†ë„ í´ë¦­ì„ ìœ„í•´ ë‹¤ì‹œ í™œì„±í™”
            btn.innerText = "â˜… ì§€ê¸ˆ í´ë¦­!!! â˜…";
            btn.style.background = "#00ff00";
        }, Math.random() * 2000 + 1500);
    }

    function startMove() {
        status.innerText = "3ë‹¨ê³„: íƒ€ê²Ÿ ì¶”ì  (í™”ë©´ ë“œë˜ê·¸!)";
        btn.innerText = "íƒ€ê²Ÿ ë”°ë¼ê°€ëŠ” ì¤‘...";
        btn.disabled = true;
        btn.style.background = "var(--p)";
        let cnt = 0, diff = 0;
        
        mainTimer = setInterval(() => {
            let tx = screen.clientWidth/2 + Math.sin(cnt/5) * 90;
            tg.style.left = tx + 'px';
            updateUI();
            diff += Math.abs(ax - tx);
            
            if(++cnt > 80) {
                clearInterval(mainTimer);
                score.move = diff / 80;
                showResult();
            }
        }, 50);
    }

    function showResult() {
        stage = 5;
        status.innerText = "ëª¨ë“  ì¸¡ì • ì™„ë£Œ!";
        btn.style.display = "none";
        resultBox.style.display = "block";
        
        let gun = "M416";
        if (score.recoil < 32 && score.react < 240) gun = "Beryl M762";
        else if (score.recoil < 42) gun = "AUG";
        else if (score.react < 270) gun = "UMP45";

        document.getElementById('res-gun').innerText = "ì¶”ì²œ ì´ê¸°: " + gun;
        document.getElementById('res-score').innerText = 
            `[ë°ì´í„°] ë°˜ë™: ${Math.round(score.recoil)} / ë°˜ì‘: ${Math.round(score.react)}ms / ë¬´ë¹™: ${Math.round(score.move)}`;
    }

    // ì²« ì‹¤í–‰ ì‹œ ì´ˆê¸°í™”
    window.onload = resetAll;
</script>
</body>
</html>
