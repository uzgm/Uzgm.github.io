<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hardcore Aim - zgm Studio</title>
  <style>
    body {
      margin: 0; background: #050505; color: white;
      font-family: 'Pretendard', sans-serif; overflow: hidden; cursor: crosshair;
      display: flex; flex-direction: column; height: 100vh;
    }
    .stats {
      height: 70px; display: flex; justify-content: space-around; align-items: center;
      background: #111; border-bottom: 3px solid #00f2fe; z-index: 10;
      font-size: 1.1rem; font-weight: bold;
    }
    #score { color: #00f2fe; font-size: 1.5rem; }
    #combo { color: #ffeb3b; font-size: 1.5rem; }
    
    #game-space {
      position: relative; flex-grow: 1; width: 100vw;
      background: radial-gradient(circle, #1a1a1a 0%, #000 100%);
    }
    .target {
      position: absolute; background: #00f2fe; border-radius: 50%;
      box-shadow: 0 0 20px #00f2fe; cursor: pointer;
      transform: translate(-50%, -50%);
      transition: transform 0.05s active;
    }
    .target:active { transform: translate(-50%, -50%) scale(0.8); }
    
    .miss-flash {
      position: absolute; inset: 0; pointer-events: none;
      background: rgba(255, 0, 85, 0.4); opacity: 0; z-index: 5;
    }
  </style>
</head>
<body>

  <div class="stats">
    <div>SCORE <span id="score">0</span></div>
    <div>COMBO <span id="combo">0</span></div>
    <div>ACC <span id="acc">100</span>%</div>
    <div>TIME <span id="time">30</span>s</div>
  </div>

  <div id="game-space">
    <div id="flash" class="miss-flash"></div>
  </div>

  <script>
    const space = document.getElementById('game-space');
    const flash = document.getElementById('flash');
    const scoreEl = document.getElementById('score');
    const accEl = document.getElementById('acc');
    const comboEl = document.getElementById('combo');
    const timeEl = document.getElementById('time');

    let score = 0, combo = 0, hits = 0, totalClicks = 0, timeLeft = 30;
    let gameActive = true;

    // 점수 및 UI 업데이트 함수 (가장 확실하게!)
    function updateUI() {
      scoreEl.textContent = score.toLocaleString();
      comboEl.textContent = combo;
      const accuracy = totalClicks === 0 ? 100 : ((hits / totalClicks) * 100).toFixed(1);
      accEl.textContent = accuracy;
    }

    function createTarget() {
      if (!gameActive) return;

      const target = document.createElement('div');
      const size = Math.max(15, 50 - (hits / 2.5)); // 더 빠르게 작아짐
      target.className = 'target';
      target.style.width = size + 'px';
      target.style.height = size + 'px';

      const maxX = space.clientWidth - size;
      const maxY = space.clientHeight - size;
      
      target.style.left = (Math.random() * maxX + size/2) + 'px';
      target.style.top = (Math.random() * maxY + size/2) + 'px';

      // 클릭(타격) 이벤트
      target.onmousedown = (e) => {
        if (!gameActive) return;
        e.stopPropagation(); // 배경 클릭(미스) 방지
        
        hits++; 
        totalClicks++; 
        combo++;
        score += (100 * combo); // 콤보 가속 점수
        
        updateUI();
        target.remove();
        
        // 난이도 조절: 맞출수록 타겟이 더 많이 나옴
        createTarget(); 
        if (hits % 7 === 0) createTarget(); 
      };

      space.appendChild(target);

      // 일정 시간 후 소멸 (미스 처리)
      setTimeout(() => {
        if (target.parentElement && gameActive) {
          target.remove();
          combo = 0; // 타겟 놓치면 콤보 리셋
          updateUI();
          createTarget();
        }
      }, Math.max(500, 1500 - (hits * 20)));
    }

    // 배경 클릭 (에임 미스)
    space.onmousedown = () => {
      if (!gameActive) return;
      totalClicks++;
      combo = 0; // 빗나가면 콤보 리셋
      updateUI();
      
      // 화면 붉은색 번쩍
      flash.style.opacity = '1';
      setTimeout(() => { flash.style.opacity = '0'; }, 100);
    };

    // 타이머
    const timer = setInterval(() => {
      if (!gameActive) return;
      timeLeft--;
      timeEl.textContent = timeLeft;
      
      if (timeLeft <= 0) {
        gameActive = false;
        clearInterval(timer);
        alert(`훈련 종료!\n점수: ${score.toLocaleString()}\n정확도: ${accEl.textContent}%\n최종 등급: ${getRank(score)}`);
        location.reload();
      }
    }, 1000);

    function getRank(s) {
      if (s > 50000) return "오버로드 (OVERLORD)꽤 잘하시개";
      if (s > 30000) return "도미네이터 (DOMINATOR)이정도면 탈인간급";
      if (s > 10000) return "언더그라운드 (UNDERGROUND)프로게이머 가능?";
      return "캡슐 (CAPSULE)";
    }

    // 게임 즉시 시작
    createTarget();
  </script>
</body>
</html>
