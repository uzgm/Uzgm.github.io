<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ê·¸ë¦¼íŒ</title>
    <style>
        :root {
            --panel-bg: #1e1e1e;
            --accent: #ffeb3b; /* ëŒ•ëŒ•ì´ ëŠë‚Œì˜ ë…¸ë€ìƒ‰ í¬ì¸íŠ¸ */
            --text: #ffffff;
        }
        body {
            margin: 0; background: #121212; color: var(--text);
            font-family: 'Pretendard', sans-serif;
            display: flex; flex-direction: column; height: 100vh;
            overflow: hidden; touch-action: none; /* ì „ì²´ ìŠ¤í¬ë¡¤ ë°©ì§€ */
        }

        /* ğŸ“± ëª¨ë°”ì¼ ìµœì í™” íˆ´ë°” (ê°€ë¡œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥) */
        .toolbar {
            background: var(--panel-bg);
            padding: 10px;
            display: flex; align-items: center; gap: 15px;
            overflow-x: auto; /* ë„êµ¬ê°€ ë§ì•„ì§€ë©´ ì˜†ìœ¼ë¡œ ë°€ì–´ì„œ í™•ì¸ */
            white-space: nowrap;
            border-bottom: 2px solid #333;
            -webkit-overflow-scrolling: touch;
        }
        /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° */
        .toolbar::-webkit-scrollbar { display: none; }

        .tool-group { 
            display: flex; align-items: center; gap: 8px; 
            border-right: 1px solid #444; padding-right: 15px;
            flex-shrink: 0;
        }
        
        label { font-size: 0.75rem; color: #888; font-weight: 900; }
        input[type="color"] { border: none; width: 30px; height: 30px; background: none; -webkit-appearance: none; }
        input[type="range"] { width: 80px; accent-color: var(--accent); }

        button {
            background: #333; color: white; border: none; padding: 10px 14px;
            border-radius: 8px; cursor: pointer; font-size: 0.85rem; font-weight: bold;
            flex-shrink: 0;
        }
        button:active { transform: scale(0.95); opacity: 0.8; }
        button.active { background: var(--accent); color: #000; }
        button.save { background: #00e676; color: #000; }

        /* ìº”ë²„ìŠ¤ ì˜ì—­ */
        .canvas-container {
            flex: 1; display: flex; justify-content: center; align-items: center;
            background: #252525; padding: 10px;
        }
        canvas {
            background: white; border-radius: 5px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
            touch-action: none; /* í„°ì¹˜ ë“œë¡œì‰ í•„ìˆ˜ */
        }

        /* í•˜ë‹¨ ì•ˆë‚´ë°” */
        .footer {
            background: #1e1e1e; font-size: 0.7rem; color: #666;
            text-align: center; padding: 5px;
        }
    </style>
</head>
<body>

    <header class="toolbar">
        <div class="tool-group">
            <label>COLOR</label>
            <input type="color" id="colorPicker" value="#000000">
        </div>
        <div class="tool-group">
            <label>SIZE</label>
            <input type="range" id="lineWidth" min="1" max="40" value="5">
        </div>
        <button id="eraserBtn">ì§€ìš°ê°œ</button>
        <button id="clearBtn">ì „ì²´ì‚­ì œ</button>
        <button id="saveBtn" class="save">ì €ì¥</button>
    </header>

    <main class="canvas-container">
        <canvas id="paintCanvas"></canvas>
    </main>

    <footer class="footer">ê·¸ë¦¼íŒ</footer>

    <script>
        const canvas = document.getElementById('paintCanvas');
        const ctx = canvas.getContext('2d');
        const colorPicker = document.getElementById('colorPicker');
        const lineWidth = document.getElementById('lineWidth');
        const clearBtn = document.getElementById('clearBtn');
        const eraserBtn = document.getElementById('eraserBtn');
        const saveBtn = document.getElementById('saveBtn');

        let isDrawing = false;
        let isEraser = false;

        function initCanvas() {
            // í™”ë©´ í¬ê¸°ì— ë§ì¶° ìº”ë²„ìŠ¤ ë¹„ìœ¨ ì„¤ì •
            const container = canvas.parentElement;
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
            
            ctx.fillStyle = "white";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ì„  ìŠ¤íƒ€ì¼ ì´ˆê¸° ì„¤ì •
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
        }

        window.addEventListener('resize', initCanvas);
        initCanvas();

        function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            // í„°ì¹˜ì™€ ë§ˆìš°ìŠ¤ ì¢Œí‘œ í†µí•© ì²˜ë¦¬
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            return {
                x: clientX - rect.left,
                y: clientY - rect.top
            };
        }

        function start(e) {
            isDrawing = true;
            const {x, y} = getPos(e);
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        function move(e) {
            if (!isDrawing) return;
            e.preventDefault(); // ìŠ¤í¬ë¡¤ ë°©ì§€
            const {x, y} = getPos(e);
            
            ctx.lineWidth = lineWidth.value;
            ctx.strokeStyle = isEraser ? "white" : colorPicker.value;
            
            ctx.lineTo(x, y);
            ctx.stroke();
        }

        function end() {
            isDrawing = false;
        }

        // í„°ì¹˜ ì´ë²¤íŠ¸ (ëª¨ë°”ì¼ìš©)
        canvas.addEventListener('touchstart', start, {passive: false});
        canvas.addEventListener('touchmove', move, {passive: false});
        canvas.addEventListener('touchend', end);

        // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ (PC ê²¸ìš©)
        canvas.addEventListener('mousedown', start);
        canvas.addEventListener('mousemove', move);
        window.addEventListener('mouseup', end);

        // ê¸°ëŠ¥ ë²„íŠ¼
        eraserBtn.onclick = () => {
            isEraser = !isEraser;
            eraserBtn.classList.toggle('active');
            eraserBtn.innerText = isEraser ? "íœ ëª¨ë“œ" : "ì§€ìš°ê°œ";
        };

        clearBtn.onclick = () => {
            if(confirm("ğŸ¶ë‹¤ ì§€ìš¸ê±°ì•¼?ğŸ¶")) {
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }
        };

        saveBtn.onclick = () => {
            const data = canvas.toDataURL("image/png");
            const link = document.createElement('a');
            link.href = data;
            link.download = 'zgm-art.png';
            link.click();
        };

    </script>
</body>
</html>
